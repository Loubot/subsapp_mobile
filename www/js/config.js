// Generated by CoffeeScript 1.10.0
window.logged_in_user = null;

window.myApp = angular.module('myApp', ['ngRoute', 'ngAnimate']);

myApp.config(function($routeProvider) {
  return $routeProvider.when('/', {
    controller: 'login_controller',
    templateUrl: 'views/login.html'
  }).when('/register', {
    controller: 'register_controller',
    templateUrl: 'views/register.html'
  });
});

angular.module('myApp.controllers', []);

myApp.constant('RESOURCES', (function() {
  var url;
  url = 'http://localhost:1337';
  return {
    DOMAIN: url
  };
})());

myApp.controller('register_controller', function($scope, $http, $location, RESOURCES) {
  return $scope.register_submit = function() {
    alert('c');
    $http.post(RESOURCES.DOMAIN + "/auth/signup", $scope.register_form_data).success(function(data) {
      var logged_in_user;
      $scope.register_form_data = {};
      $scope.returned = data;
      logged_in_user = data;
      console.log("user " + JSON.stringify(logged_in_user));
    }).error(function(err) {
      $scope.errorMessage = err;
    });
  };
});

myApp.controller('login_controller', function($scope, $http, $location, RESOURCES) {
  console.log('login conteroller');
  $scope.user = {};
  console.log('RESOURCES.DOMAIN ' + RESOURCES.DOMAIN);
  return $scope.login_submit = function() {
    alert('b');
    $http.post(RESOURCES.DOMAIN + "/auth/signin", $scope.login_form_data).success(function(data) {
      var logged_in_user;
      $location.path('/register');
      $scope.login_form_data = {};
      $scope.returned = data;
      logged_in_user = data;
      console.log("user " + JSON.stringify(logged_in_user));
    }).error(function(err) {
      $scope.errorMessage = err;
    });
  };
});

$(document).ready(function() {});
